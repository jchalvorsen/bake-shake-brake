\section{The Finite Element Method in 3D}
\label{sec:FEM}

The linear elasticity equation \eqref{eq:linEl} can be written in matrix form as

\begin{align*}
\begin{bmatrix}
\frac{\partial}{\partial x}, & \frac{\partial}{\partial y}, & \frac{\partial}{\partial z}
\end{bmatrix}
\begin{bmatrix}
\sigma_{xx} & \sigma_{xy} & \sigma_{xz} \\
\sigma_{xy} & \sigma_{yy} & \sigma_{yz} \\
\sigma_{xz} & \sigma_{yz} & \sigma_{zz}
\end{bmatrix} = -
\begin{bmatrix}
f_x, & f_y, & f_z 
\end{bmatrix}.
\end{align*}

Let us for simplicity assume homogeneous Dirichlet boundary conditions on $\partial \Omega_D$. Multiplying with a test function $\bm{v}$ and integrating over the domain $\Omega$, we end up with the weak formulation. 

\begin{equation}
\int_\Omega \bm{\epsilon}(\bm{v})^T \bm{C} \bm{\epsilon}(\bm{u}) \, d\Omega = \int_\Omega \bm{v}^T \bm{f} \, d\Omega
\end{equation}

Now, we substitute the test function by linear basis functions $\bm{v} = \bm{\phi_i}$ and skipping some details we end up with the linear system for one element,

\begin{equation}
\label{eq:linear-system}
\bm{A}^e \bm{u}^e = \bm{b}^e.
\end{equation}

$\bm{A}^e$ is the stiffness element matrix,

\begin{align}
\bm{A}^e = \int_\Omega \bm{B}^T \bm{C} \bm{B} \, d\Omega = \bm{B}^T \bm{C} \bm{B} \cdot V^e
\end{align}
where $V^e$ is the volume of the current element. Because the integrand is constant, we can substitute the integral by the volume of the domain. $\bm{b}^e$ is the element load vector with the $i^{th}$ element 

\begin{align}
\label{eq:load-vector}
b^e_i = 
\int_{\Omega} \bm{\phi_i} \bm{f} \, d\Omega.
\end{align}

If $\bm{f}$ is a constant in the element (typically a result of mass density) then \eqref{eq:load-vector} can be calculated exact by a 1 order Gauss quadrature, since the basis functions are linear. 

We have now presented a linear system for one element. Iterating over all elements, and mapping to a stiffness matrix $\bm{A}$ and load vector $\bm{b}$, we obtain a linear system for all the nodes in our geometry. 

\begin{equation}
\bm{A} \bm{u} = \bm{b}
\end{equation}

with $\bm{u}$ being the displacement vector for all the nodes in the system. The ordering