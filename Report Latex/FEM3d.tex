\section{The Finite Element Method in 3D}

The linear elasticity equation \eqref{eq:linEl} can be written in matrix form as

\begin{align*}
\begin{bmatrix}
\frac{\partial}{\partial x}, & \frac{\partial}{\partial y}, & \frac{\partial}{\partial z}
\end{bmatrix}
\begin{bmatrix}
\sigma_{xx} & \sigma_{xy} & \sigma_{xz} \\
\sigma_{xy} & \sigma_{yy} & \sigma_{yz} \\
\sigma_{xz} & \sigma_{yz} & \sigma_{zz}
\end{bmatrix} = -
\begin{bmatrix}
f_x, & f_y, & f_z 
\end{bmatrix}.
\end{align*}

Let us for simplicity assume homogeneous Dirichlet boundary conditions on $\partial \Omega_D$. Multiplying with a test function $\bm{v}$ and integrating over the domain $\Omega$, we end up with the weak formulation. 

\begin{equation}
\int_\Omega \bm{\epsilon}(\bm{v})^T \bm{C} \bm{\epsilon}(\bm{u}) \, dA = \int_\Omega \bm{v}^T \bm{f} \, dA
\end{equation}

Now, we substitute the test function by linear basis functions $\bm{v} = \bm{\phi}$ and skipping some details we end up with the linear system for one element,

\begin{equation}
\label{eq:linear-system}
\bm{A^e} \bm{u^e} = \bm{b^e}.
\end{equation}

The stiffness element matrix is

\begin{align}
\bm{A^e} = \int_\Omega \bm{B}^T \bm{C} \bm{B} \, d\Omega = \bm{B}^T \bm{C} \bm{B} \cdot V^e
\end{align}
where $V^e$ is the volume of the current element. The load vector is

\begin{align}
\label{eq:load-vector}
\bm{b^e}_i = 
\int_{\Omega} \bm{\phi_i} \bm{f} \, dA 
\end{align}

If $\bm{f}$ is a constant in the element (typically a result of mass density) then \eqref{eq:load-vector} can be calculated exact by Gauss quadrature of order 1, since the basis functions are linear. 

We have now presented a linear system for one element. Iterating over all elements, and mapping to a stiffness matrix $\bm{A}$ and load vector $\bm{b}$, we obtain a linear system for all the nodes in our geometry. 

\begin{equation}
\bm{A} \bm{u} = \bm{b}
\end{equation}

with $\bm{u}$ being the displacement vector for all the nodes in our system. 